"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[2450,1321,8532,758],{90758:function(e,t,s){s.r(t);var n=s(74165),a=s(15861),r=s(29439),l=s(72791),o=s(78983),c=s(10935),i=s(36167),u=s(26213),d=s(50989),x=s(57689),m=s(69835),p=s(94810),f=s(68631),h=s(80184);t.default=function(){var e="5836103512:AAFoXHwI8PsQ6_xeqcx0IawMbc7njLwJydQ",t="https://proj.uley.team",s="1775583141",v=(0,u.Z)().users,g=(0,u.Z)(),b=g.addNewMessage,j=g.setDistributions,y=(0,l.useState)([]),k=(0,r.Z)(y,2),Z=k[0],S=k[1],w=(0,l.useState)([]),_=(0,r.Z)(w,2),I=_[0],N=_[1],C=(0,l.useState)(""),F=(0,r.Z)(C,2),A=F[0],O=F[1],T=(0,l.useState)(0),D=(0,r.Z)(T,2),J=(D[0],D[1]),H=(0,l.useState)(!1),P=(0,r.Z)(H,2),B=P[0],E=P[1],L=(0,l.useState)(!1),M=(0,r.Z)(L,2),Q=M[0],q=M[1],G=(0,l.useState)(!1),K=(0,r.Z)(G,2),R=K[0],U=K[1],W=(0,l.useState)(""),X=(0,r.Z)(W,2),$=X[0],z=X[1],V=(0,l.useState)(),Y=(0,r.Z)(V,2),ee=Y[0],te=Y[1],se=(0,l.useState)(""),ne=(0,r.Z)(se,2),ae=ne[0],re=ne[1],le=(0,l.useState)(""),oe=(0,r.Z)(le,2),ce=oe[0],ie=oe[1],ue=new Audio(f),de=(0,x.s0)();(0,l.useEffect)((function(){var e=[];v.map((function(t){var s={label:t.name,value:t.chatId};e.push(s)})),S(e)}),[v]);(0,l.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ee){e.next=10;break}return console.log("file:",ee),(t=new FormData).append("name",ee.name),t.append("photo",ee),e.next=7,(0,p.cT)(t);case 7:s=e.sent,console.log("response: ",s.data.path),ie(s.data.path.split(".team")[1]);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[ee]);var xe=function(){var r=(0,a.Z)((0,n.Z)().mark((function r(){var l,o,c,i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return l=[],0,ue.play(),o={name:"\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430",text:A,image:t+ce,button:$,receivers:JSON.stringify(I),datestart:Date.now(),delivered:"true"},console.log("message send button: ",o),r.next=7,(0,m.Gl)(o);case 7:return c=r.sent,I.map(function(){var r=(0,a.Z)((0,n.Z)().mark((function r(o,i){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:setTimeout((0,a.Z)((0,n.Z)().mark((function a(){var r,u,x,f,h,g,j,y,k,Z,S,w;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e ID: "+o.value+" \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 "+A+" \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e! \u041a\u043d\u043e\u043f\u043a\u0430 "+$+" \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430!"),l.push({label:o.label,value:o.value,status:500,mess:null}),r=v.filter((function(e){return e.chatId===o.value.toString()}))[0],u=JSON.stringify({inline_keyboard:[[{text:$,callback_data:"/report"}]]}),""===A){n.next=20;break}return console.log(l,c),f="https://api.telegram.org/bot".concat(e,"/sendMessage?chat_id=").concat(o.value,"&parse_mode=html&text=").concat(A.replace(/\n/g,"%0A")),console.log("url_send_msg: ",f),n.next=10,d.y_.get(f);case 10:if(x=n.sent,console.log("sendToTelegram: ",x),200!==x.status){n.next=20;break}return console.log("\u0441\u0442\u0430\u0442\u0443\u0441 200 \u0442\u0435\u043a\u0441\u0442",l,c.id),l[i-1].status=200,l[i-1].mess=null===(h=x.data)||void 0===h||null===(g=h.result)||void 0===g?void 0:g.message_id,console.log("res: ",{receivers:JSON.stringify(l)},c.id),n.next=20,(0,m.uH)({receivers:JSON.stringify(l)},c.id);case 20:if(j="https://api.telegram.org/bot".concat(e,"/sendPhoto?chat_id=").concat(o.value,"&reply_markup=").concat(u),console.log("url_send_photo: ",j),!ee){n.next=36;break}return(k=new FormData).append("photo",ee),n.next=27,d.y_.post(j,k);case 27:if(y=n.sent,console.log("sendPhotoToTelegram: ",y),200!==y.status||""!==A){n.next=36;break}return console.log("\u0441\u0442\u0430\u0442\u0443\u0441 200 \u0444\u043e\u0442\u043e"),l[i-1].status=200,l[i-1].mess=null===(Z=y.data)||void 0===Z||null===(S=Z.result)||void 0===S?void 0:S.message_id,n.next=36,(0,m.uH)({receivers:JSON.stringify(l)},c.id);case 36:if(!R){n.next=43;break}return w={},w=ee?{senderId:s,receiverId:o.value,conversationId:r.conversationId,type:"image",text:t+ce,is_bot:!0,messageId:y.data.result.message_id,buttons:$}:{senderId:s,receiverId:o.value,conversationId:r.conversationId,type:"text",text:A,is_bot:!0,messageId:x.data.result.message_id,buttons:""},console.log("message send: ",w),n.next=42,(0,p.rW)(w);case 42:ee?b(o.value,t+ce,"image",$,r.conversationId,y.data.result.message_id):b(o.value,A,"text","",r.conversationId,x.data.result.message_id);case 43:case"end":return n.stop()}}),a)}))),3e3*++i);case 1:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()),r.next=11,(0,m.$J)();case 11:i=r.sent,console.log("distribution new add: ",i.length),j(i),N([]),U(!1),O(""),q(!1),z(""),E(!0),re(""),de("/distribution");case 22:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return(0,h.jsxs)("div",{className:"dark-theme",children:[(0,h.jsx)(c.S8,{}),(0,h.jsxs)("div",{className:"wrapper d-flex flex-column min-vh-100 bg-uley",children:[(0,h.jsx)(c.tf,{}),(0,h.jsx)("div",{className:"body flex-grow-1 px-3",children:(0,h.jsx)(o.KB,{lg:!0,children:(0,h.jsx)(l.Suspense,{fallback:(0,h.jsx)(o.LQ,{color:"primary"}),children:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("h2",{children:"\u041d\u043e\u0432\u0430\u044f \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0430"}),(0,h.jsx)(o.rb,{children:(0,h.jsx)(o.b7,{xs:!0,children:(0,h.jsx)(o.xH,{className:"mb-4",children:(0,h.jsxs)(o.sl,{children:[(0,h.jsx)(o.Gc,{color:"success",dismissible:!0,visible:B,onClose:function(){return E(!1)},children:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e!"}),(0,h.jsxs)(o.lx,{children:[(0,h.jsxs)("div",{className:"mb-3",style:{color:"#f3f3f3"},children:[(0,h.jsx)(o.L8,{htmlFor:"exampleFormControlInput1",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u0435\u0439:"}),(0,h.jsx)(i.NU,{options:Z,value:I,onChange:N,style:{color:"#1e1919"},overrideStrings:{allItemsAreSelected:"\u0412\u0441\u0435 \u043f\u043e\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u044b",clearSearch:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043f\u043e\u0438\u0441\u043a",clearSelected:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u044b\u0431\u043e\u0440",noOptions:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e",search:"\u041f\u043e\u0438\u0441\u043a",selectAll:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0451",selectAllFiltered:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0451 (\u041d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0445)",selectSomeItems:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c...",create:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"}}),(0,h.jsxs)("p",{style:{color:"#767676"},children:["\u041f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u0435\u0439: ",(0,h.jsx)("span",{children:I.length})]})]}),(0,h.jsx)("div",{className:"mb-3",style:{color:"#f3f3f3"},children:(0,h.jsx)(o.EC,{id:"flexCheckDefault",label:"\u0414\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0430\u0434\u043c\u0438\u043d\u043a\u0443",onChange:function(e){U(e.target.value)},defaultChecked:R})}),(0,h.jsx)("div",{className:"mb-3",children:(0,h.jsx)(o.PB,{id:"exampleFormControlTextarea1",rows:3,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",onChange:function(e){O(e.target.value),J(e.target.value.length)},value:A})}),(0,h.jsx)("div",{className:"mb-6",style:{color:"#8f8888"},children:(0,h.jsx)(o.jO,{type:"file",id:"formFile",label:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"photo",onChange:function(e){return function(e){te(e.target.files[0]),re(e.target.value)}(e)},value:ae})}),(0,h.jsx)("div",{className:"mb-3"}),(0,h.jsx)("div",{className:"mb-3 text-center",children:(0,h.jsxs)("p",{style:{color:"#fff",cursor:"pointer"},onClick:function(e){e.preventDefault(),q(!Q)},children:[" ",Q?"- \u0423\u0431\u0440\u0430\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0443":"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0443"]})}),(0,h.jsx)(o.lx,{className:"row g-3",style:{color:"#8f8888",display:Q?"block":"none"},children:(0,h.jsx)(o.b7,{md:6,children:(0,h.jsx)(o.jO,{type:"text",id:"inputTextButton",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043d\u043e\u043f\u043a\u0438",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442",onChange:function(e){z(e.target.value)},value:$})})}),(0,h.jsx)("br",{}),(0,h.jsxs)("div",{className:"mb-3",style:{textAlign:"right"},children:[(0,h.jsx)(o.u5,{color:"secondary",style:{marginRight:"15px"},onClick:function(){de("/distribution")},children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,h.jsx)(o.u5,{color:"primary",onClick:xe,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443"})]})]})]})})})})]})})})}),(0,h.jsx)(c.qh,{})]})]})}},68631:function(e,t,s){e.exports=s.p+"static/media/distribution_sound.77a858448f3b5ce5598d.mp3"}}]);
//# sourceMappingURL=2450.16b5c579.chunk.js.map