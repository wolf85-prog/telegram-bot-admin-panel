"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[6717,8528,2410,758],{90758:function(e,t,s){s.r(t);var n=s(74165),a=s(15861),r=s(29439),o=s(72791),l=s(78983),c=s(48821),i=s(67128),d=(s(16687),s(11988)),u=s(69018),m=s(57689),p=s(69835),x=s(94810),f=s(68631),h=s(80184);t.default=function(){var e="5836103512:AAFoXHwI8PsQ6_xeqcx0IawMbc7njLwJydQ",t="https://proj.uley.team",s="1775583141",g=(0,d.Z)().users,v=(0,d.Z)(),b=v.addNewMessage,j=(v.setDistributions,(0,o.useState)([])),y=(0,r.Z)(j,2),k=y[0],Z=y[1],w=(0,o.useState)(null),_=(0,r.Z)(w,2),S=_[0],N=_[1],I=(0,o.useState)(""),C=(0,r.Z)(I,2),F=C[0],O=C[1],T=(0,o.useState)(0),D=(0,r.Z)(T,2),J=(D[0],D[1]),A=(0,o.useState)(!1),L=(0,r.Z)(A,2),H=L[0],P=L[1],B=(0,o.useState)(!1),E=(0,r.Z)(B,2),M=E[0],Q=E[1],q=(0,o.useState)(!1),G=(0,r.Z)(q,2),z=G[0],K=G[1],R=(0,o.useState)(""),W=(0,r.Z)(R,2),X=W[0],U=W[1],V=(0,o.useState)(),Y=(0,r.Z)(V,2),$=Y[0],ee=Y[1],te=(0,o.useState)(""),se=(0,r.Z)(te,2),ne=se[0],ae=se[1],re=(0,o.useState)(""),oe=(0,r.Z)(re,2),le=oe[0],ce=oe[1],ie=new Audio(f),de=(0,m.s0)();(0,o.useEffect)((function(){var e=[];g.map((function(t){var s={name:t.name,code:t.chatId};e.push(s)})),console.log("users: ",e),Z(e)}),[g]);(0,o.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!$){e.next=10;break}return console.log("file:",$),(t=new FormData).append("name",$.name),t.append("photo",$),e.next=7,(0,x.cT)(t);case 7:s=e.sent,console.log("response: ",s.data.path),ce(s.data.path.split(".team")[1]);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[$]);var ue=function(){var r=(0,a.Z)((0,n.Z)().mark((function r(){var o,l,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=[],0,ie.play(),l={name:"\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430",text:F,image:t+le,button:X,receivers:JSON.stringify(S),datestart:Date.now(),delivered:"true"},console.log("message send button: ",l),r.next=7,(0,p.Gl)(l);case 7:c=r.sent,S.map(function(){var r=(0,a.Z)((0,n.Z)().mark((function r(l,i){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:setTimeout((0,a.Z)((0,n.Z)().mark((function a(){var r,d,m,f,h,v,j,y,k,Z,w,_;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e ID: "+l.code+" \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 "+F+" \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e! \u041a\u043d\u043e\u043f\u043a\u0430 "+X+" \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430!"),o.push({label:l.name,value:l.code,status:500,mess:null}),r=g.find((function(e){return e.chatId===l.code})),console.log("client: ",r),d=JSON.stringify({inline_keyboard:[[{text:X,callback_data:"/report"}]]}),""===F){n.next=21;break}return console.log(o,c),f="https://api.telegram.org/bot".concat(e,"/sendMessage?chat_id=").concat(l.code,"&parse_mode=html&text=").concat(F.replace(/\n/g,"%0A")),console.log("url_send_msg: ",f),n.next=11,u.y_.get(f);case 11:if(m=n.sent,console.log("sendToTelegram: ",m),200!==m.status){n.next=21;break}return console.log("\u0441\u0442\u0430\u0442\u0443\u0441 200 \u0442\u0435\u043a\u0441\u0442",o,c.id),o[i-1].status=200,o[i-1].mess=null===(h=m.data)||void 0===h||null===(v=h.result)||void 0===v?void 0:v.message_id,console.log("res: ",{receivers:JSON.stringify(o)},c.id),n.next=21,(0,p.uH)({receivers:JSON.stringify(o)},c.id);case 21:if(j="https://api.telegram.org/bot".concat(e,"/sendPhoto?chat_id=").concat(l.code,"&reply_markup=").concat(d),console.log("url_send_photo: ",j),!$){n.next=37;break}return(k=new FormData).append("photo",$),n.next=28,u.y_.post(j,k);case 28:if(y=n.sent,console.log("sendPhotoToTelegram: ",y),200!==y.status||""!==F){n.next=37;break}return console.log("\u0441\u0442\u0430\u0442\u0443\u0441 200 \u0444\u043e\u0442\u043e"),o[i-1].status=200,o[i-1].mess=null===(Z=y.data)||void 0===Z||null===(w=Z.result)||void 0===w?void 0:w.message_id,n.next=37,(0,p.uH)({receivers:JSON.stringify(o)},c.id);case 37:if(!z){n.next=44;break}return _={},_=$?{senderId:s,receiverId:l.code,conversationId:r.conversationId,type:"image",text:t+le,is_bot:!0,messageId:y.data.result.message_id,buttons:X}:{senderId:s,receiverId:l.code,conversationId:r.conversationId,type:"text",text:F,is_bot:!0,messageId:m.data.result.message_id,buttons:""},console.log("message send: ",_),n.next=43,(0,x.rW)(_);case 43:$?b(l.code,t+le,"image",X,r.conversationId,y.data.result.message_id):b(l.code,F,"text","",r.conversationId,m.data.result.message_id);case 44:case"end":return n.stop()}}),a)}))),3e3*++i);case 1:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()),N([]),K(!1),O(""),Q(!1),U(""),P(!0),ae("");case 16:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return(0,h.jsxs)("div",{className:"dark-theme",children:[(0,h.jsx)(c.S8,{}),(0,h.jsxs)("div",{className:"wrapper d-flex flex-column min-vh-100 bg-uley",children:[(0,h.jsx)(c.tf,{}),(0,h.jsx)("div",{className:"body flex-grow-1 px-3",children:(0,h.jsx)(l.KB,{lg:!0,children:(0,h.jsx)(o.Suspense,{fallback:(0,h.jsx)(l.LQ,{color:"primary"}),children:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("h2",{children:"\u041d\u043e\u0432\u0430\u044f \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0430"}),(0,h.jsx)(l.rb,{children:(0,h.jsx)(l.b7,{xs:!0,children:(0,h.jsx)(l.xH,{className:"mb-4",children:(0,h.jsxs)(l.sl,{children:[(0,h.jsx)(l.Gc,{color:"success",dismissible:!0,visible:H,onClose:function(){return P(!1)},children:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e!"}),(0,h.jsxs)(l.lx,{children:[(0,h.jsxs)("div",{className:"mb-3",style:{color:"#f3f3f3"},children:[(0,h.jsx)(l.L8,{htmlFor:"exampleFormControlInput1",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u0435\u0439:"}),(0,h.jsx)(i.N,{id:"exampleFormControlInput1",value:S,onChange:function(e){return function(e){console.log(S),N(e.value)}(e)},options:k,optionLabel:"name",maxSelectedLabels:3,className:"w-full md:w-20rem",filter:!0,virtualScrollerOptions:{itemSize:43},placeholder:""}),(0,h.jsxs)("p",{style:{color:"#767676"},children:["\u041f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u0435\u0439: ",(0,h.jsx)("span",{children:null===S||void 0===S?void 0:S.length})]})]}),(0,h.jsx)("div",{className:"mb-3",style:{color:"#f3f3f3"},children:(0,h.jsx)(l.EC,{id:"flexCheckDefault",label:"\u0414\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0430\u0434\u043c\u0438\u043d\u043a\u0443",onChange:function(e){console.log(!z),K(!z)},defaultChecked:z})}),(0,h.jsx)("div",{className:"mb-3",children:(0,h.jsx)(l.PB,{id:"exampleFormControlTextarea1",rows:3,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",onChange:function(e){O(e.target.value),J(e.target.value.length)},value:F})}),(0,h.jsx)("div",{className:"mb-6",style:{color:"#8f8888"},children:(0,h.jsx)(l.jO,{type:"file",id:"formFile",label:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"photo",onChange:function(e){return function(e){ee(e.target.files[0]),ae(e.target.value)}(e)},value:ne})}),(0,h.jsx)("div",{className:"mb-3"}),(0,h.jsx)("div",{className:"mb-3 text-center",children:(0,h.jsxs)("p",{style:{color:"#fff",cursor:"pointer"},onClick:function(e){e.preventDefault(),Q(!M)},children:[" ",M?"- \u0423\u0431\u0440\u0430\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0443":"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0443"]})}),(0,h.jsx)(l.lx,{className:"row g-3",style:{color:"#8f8888",display:M?"block":"none"},children:(0,h.jsx)(l.b7,{md:6,children:(0,h.jsx)(l.jO,{type:"text",id:"inputTextButton",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043d\u043e\u043f\u043a\u0438",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442",onChange:function(e){U(e.target.value)},value:X})})}),(0,h.jsx)("br",{}),(0,h.jsxs)("div",{className:"mb-3",style:{textAlign:"right"},children:[(0,h.jsx)(l.u5,{color:"secondary",style:{marginRight:"15px"},onClick:function(){de("/distribution")},children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,h.jsx)(l.u5,{color:"primary",onClick:ue,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443"})]})]})]})})})})]})})})}),(0,h.jsx)(c.qh,{})]})]})}},68631:function(e,t,s){e.exports=s.p+"static/media/distribution_sound.77a858448f3b5ce5598d.mp3"}}]);
//# sourceMappingURL=6717.34f0d478.chunk.js.map