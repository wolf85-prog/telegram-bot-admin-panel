{"version":3,"file":"static/js/758.1c7fe742.chunk.js","mappings":"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","sources":["pages/DistributionAdd.js"],"sourcesContent":["import React, { Suspense, useState, useEffect } from 'react'\nimport { CContainer, CSpinner } from '@coreui/react'\nimport { AppSidebar, AppFooter, AppHeader } from '../components/index'\nimport { \n  CRow,\n  CCol,\n  CCard,\n  CCardBody,\n  CForm,\n  CFormLabel,\n  CFormInput,\n  CFormTextarea,\n  CButton,\n  CAlert,\n  CFormCheck,\n} from '@coreui/react'\n\nimport { MultiSelect } from \"react-multi-select-component\";\nimport { useUsersContext } from \"./../chat-app-new/context/usersContext\";\nimport { $host } from './../http/index'\nimport { useNavigate } from 'react-router-dom';\nimport { newDistribution, getDistributions } from './../http/adminAPI';\nimport { newMessage, uploadFile } from './../http/chatAPI';\nimport sendSound from './../chat-app-new/assets/sounds/distribution_sound.mp3';\n\nconst DistributionAdd = () => {\n\n  const token = process.env.REACT_APP_TELEGRAM_API_TOKEN\n\tconst host = process.env.REACT_APP_HOST\n  const hostPort = process.env.REACT_APP_API_URL\n  const chatAdminId = process.env.REACT_APP_CHAT_ADMIN_ID\n\n  const { users: clients } = useUsersContext();\n  const { addNewMessage, setDistributions } = useUsersContext();\n  const [contacts, setContacts]= useState([]);\n\n  const [selected, setSelected] = useState([]);\n  const [text, setText] = useState('');\n  const [countChar, setCountChar] = useState(0);\n  const [visible, setVisible] = useState(false);\n  const [showEditButtonAdd, setShowEditButtonAdd] = useState(false);\n  const [sendToAdmin, setSendToAdmin] = useState(false);\n  const [textButton, setTextButton] = useState('');\n  const [file, setFile] = useState();\n  const [value, setValue] = useState(\"\");\n  const [image, setImage]= useState(\"\");\n\n  const audio = new Audio(sendSound);\n\n  const navigate = useNavigate();\n\n  const backPage = () => {\n       navigate('/distribution');\n  } \n\n  useEffect(() => {\n    const arrClients = []\n    \n    clients.map((client) => {\n      const newObj = {\n        label: client.name, \n        value: client.chatId,\n      }\n      arrClients.push(newObj)\n    })\n    setContacts(arrClients)      \n  }, [clients]);\n\n  const onChangeText = (e) => {\n    setText(e.target.value)\n    setCountChar(e.target.value.length)\n  }\n\n  useEffect(() => {\n    const getImage = async () => {\n        if (file) {\n          console.log(\"file:\", file)\n          const data = new FormData();\n          data.append(\"name\", file.name);\n          data.append(\"photo\", file);\n          \n          let response = await uploadFile(data);\n          console.log(\"response: \", response.data.path)\n\n          setImage(response.data.path.split('.team')[1]);\n          //сообщение с ссылкой на файл\n          //console.log(host + response.data.path)\n          //setValue(host + response.data.path)\n        }\n    }\n    getImage();\n  }, [file])\n\n  {/* Добавление файла */}\n  const onFileChange = (e) => {\n    setFile(e.target.files[0]);\n    setValue(e.target.value)\n  }\n\n  {/* Показать Добавление текста кнопки */}\n  const clickShowEditButton = (e) => {\n    e.preventDefault();\n    showEditButtonAdd ? setShowEditButtonAdd (false) : setShowEditButtonAdd (true)\n  }\n\n  const onChangeTextButton = (e) => {\n    setTextButton(e.target.value)\n  }\n\n  const onChangeCheck = (e) => {\n    setSendToAdmin(e.target.value)\n  }\n\n  {/* Отправка рассылки */}\n  const onSendText = async() => {\n    console.log(selected)\n\n    audio.play();\n\n    //новая рассылка\n    const message = {\n      name: 'Рассылка', \n      text: text, \n      image: host + image, \n      button: textButton, \n      receivers: JSON.stringify(selected), \n      datestart: Date.now(), \n      delivered: 'true',        \n    }\n    console.log(\"message send button: \", message);\n\n    //сохранение рассылки в базе данных\n    await newDistribution(message)\n    \n    selected.map(async (user, index) => {\n      console.log(\"Пользователю ID: \" + user.value + \" сообщение \" + text + \" отправлено! Кнопка \" + textButton + \" отправлена!\")\n\n      let client = clients.filter((client) => client.chatId === user.value.toString())[0];\n      \n      //Передаем данные боту\n      const keyboard = JSON.stringify({\n        inline_keyboard: [\n            [\n                {\"text\": textButton, callback_data:'/report'},\n            ],\n        ]\n      });\n\n      //отправить в телеграмм\n      let sendToTelegram\n      if (text !== '') {\n        const url_send_msg = `https://api.telegram.org/bot${token}/sendMessage?chat_id=${user.value}&parse_mode=html&text=${text.replace(/\\n/g, '%0A')}`\n        console.log(\"url_send_msg: \", url_send_msg)\n        sendToTelegram = await $host.get(url_send_msg);\n        console.log('sendToTelegram: ', sendToTelegram)\n      }  \n\n      const url_send_photo = `https://api.telegram.org/bot${token}/sendPhoto?chat_id=${user.value}&reply_markup=${keyboard}`\n      console.log(\"url_send_photo: \", url_send_photo)\n      \n      let sendPhotoToTelegram\n      if (file) {\n        const form = new FormData();\n        form.append(\"photo\", file);\n\n        sendPhotoToTelegram = await $host.post(url_send_photo, form);\n        console.log('sendPhotoToTelegram: ', sendPhotoToTelegram)\n      } \n\n      //отправить в админку\n      if (sendToAdmin) {\n        let message = {};\n        if(!file) {\n            message = {\n                senderId: chatAdminId, \n                receiverId: user.value,\n                conversationId: client.conversationId,\n                type: \"text\",\n                text: text,\n                is_bot: true,\n\t\t\t\t        messageId: sendToTelegram.data.result.message_id,\n                buttons: '',\n            }\n        } else {\n            message = {\n                senderId: chatAdminId, \n                receiverId: user.value,\n                conversationId: client.conversationId,\n                type: \"image\",\n                text: host + image,\n                is_bot: true,\n\t\t\t\t        messageId: sendPhotoToTelegram.data.result.message_id,\n                buttons: textButton,\n            }\n        }\n        console.log(\"message send: \", message);\n\n        //сохранение сообщения в базе данных\n\t\t    await newMessage(message)\n\n\t\t    //сохранить в контексте\n        if(!file) {\n          addNewMessage(user.value, text, 'text', '', client.conversationId, sendToTelegram.data.result.message_id);\n        } else {\n          addNewMessage(user.value, host + image, 'image', textButton, client.conversationId, sendPhotoToTelegram.data.result.message_id);\n        }\n  \n      }  \n\n      //обновить список рассылок\n      let response = await getDistributions();\n      console.log(\"distribution new add: \", response.length)\n\t\t\tsetDistributions(response)\n\n    })\n\n    setSelected([])\n    setSendToAdmin(false)\n    setText('')\n    setShowEditButtonAdd(false)\n    setTextButton('')\n    setVisible(true)\n    setValue('')\n\n    navigate('/distribution');\n  }\n\n  return (\n    <div className='dark-theme'>\n      <AppSidebar />\n      <div className=\"wrapper d-flex flex-column min-vh-100 bg-uley\">\n        <AppHeader />\n        <div className=\"body flex-grow-1 px-3\">\n\n            <CContainer lg>\n                <Suspense fallback={<CSpinner color=\"primary\" />}>\n                  <>\n                    <h2>Новая рассылка</h2>\n\n                    <CRow>\n                        <CCol xs>\n                          <CCard className=\"mb-4\">\n                            {/* <CCardHeader>Рассылки</CCardHeader> */}\n                            <CCardBody>\n                            <CAlert color=\"success\" dismissible visible={visible} onClose={() => setVisible(false)}>\n                              Сообщение успешно отправлено!\n                            </CAlert>\n                              <CForm>\n                                <div className=\"mb-3\" style={{color: '#f3f3f3'}}>\n                                  <CFormLabel htmlFor=\"exampleFormControlInput1\">Выберите получателей:</CFormLabel>\n                                  <MultiSelect\n                                    options={contacts}\n                                    value={selected}\n                                    onChange={setSelected}\n                                    style={{color: '#1e1919'}}\n                                    overrideStrings={{\n                                      \"allItemsAreSelected\": \"Все поля выбраны\",\n                                      \"clearSearch\": \"Очистить поиск\",\n                                      \"clearSelected\": \"Очистить выбор\",\n                                      \"noOptions\": \"Ничего не найдено\",\n                                      \"search\": \"Поиск\",\n                                      \"selectAll\": \"Выбрать всё\",\n                                      \"selectAllFiltered\": \"Выбрать всё (Найденных)\",\n                                      \"selectSomeItems\": \"Выбрать...\",\n                                      \"create\": \"Создать\",\n                                    }}   \n                                  />\n                                  <p style={{color: '#767676'}}>Получателей: <span>{selected.length}</span></p>\n                                </div>\n\n                                <div className='mb-3' style={{color: '#f3f3f3'}}>\n                                  <CFormCheck \n                                    id=\"flexCheckDefault\" \n                                    label=\"Дублировать в админку\"\n                                    onChange={onChangeCheck}\n                                    defaultChecked={sendToAdmin}\n                                  />\n                                </div>\n\n                                <div className=\"mb-3\">\n                                  {/* <CFormLabel htmlFor=\"exampleFormControlTextarea1\">Текст сообщения</CFormLabel> */}\n                                  <CFormTextarea \n                                    id=\"exampleFormControlTextarea1\" \n                                    rows={3} \n                                    placeholder='Введите текст сообщения'\n                                    onChange={onChangeText}\n                                    value={text}\n                                    // helperText = {`${countChar}/500`}\n                                  >           \n                                  </CFormTextarea>\n                                </div>\n                              \n\n                                {/* Добавление картинки */}\n                                <div className=\"mb-6\" style={{color: '#8f8888'}}>\n                                  <CFormInput \n                                    type=\"file\" \n                                    id=\"formFile\" \n                                    label=\"Добавить картинку\" \n                                    name=\"photo\"\n                                    onChange={(e) => onFileChange(e)}\n                                    value={value}\n                                  />\n                                </div>\n\n                                <div className=\"mb-3\"></div>\n\n                                <div className=\"mb-3 text-center\">\n                                  <p style={{color: '#fff', cursor: 'pointer'}} onClick={clickShowEditButton} > {showEditButtonAdd ? '- Убрать кнопку' : '+ Добавить кнопку'}</p>\n                                </div>\n\n                                {/* Добавление кнопки */}\n                                <CForm className=\"row g-3\" style={{color: '#8f8888', display: showEditButtonAdd ? \"block\" : \"none\" }}>\n                                  <CCol md={6}>\n                                    <CFormInput \n                                      type=\"text\" \n                                      id=\"inputTextButton\" \n                                      label=\"Название кнопки\" \n                                      placeholder=\"Введите текст\"\n                                      onChange={onChangeTextButton}\n                                      value={textButton}\n                                    />\n                                  </CCol>\n                                </CForm>\n                                <br/>\n                                <div className=\"mb-3\" style={{textAlign: 'right'}}>\n                                  <CButton color=\"secondary\" style={{marginRight: '15px'}} onClick={backPage}>Отмена</CButton>\n                                  <CButton color=\"primary\" onClick={onSendText}>Отправить рассылку</CButton>\n                                </div>\n                              </CForm>\n\n                            </CCardBody>\n                          </CCard>\n                        </CCol>\n                      </CRow>\n                  </>\n                </Suspense>\n            </CContainer>\n\n        </div>\n        <AppFooter />\n      </div>\n    </div>\n  )\n}\n\nexport default DistributionAdd\n"],"names":["token","process","host","chatAdminId","clients","useUsersContext","users","_useUsersContext2","addNewMessage","setDistributions","_useState","useState","_useState2","_slicedToArray","contacts","setContacts","_useState3","_useState4","selected","setSelected","_useState5","_useState6","text","setText","_useState7","_useState8","setCountChar","_useState9","_useState10","visible","setVisible","_useState11","_useState12","showEditButtonAdd","setShowEditButtonAdd","_useState13","_useState14","sendToAdmin","setSendToAdmin","_useState15","_useState16","textButton","setTextButton","_useState17","_useState18","file","setFile","_useState19","_useState20","value","setValue","_useState21","_useState22","image","setImage","audio","Audio","sendSound","navigate","useNavigate","useEffect","arrClients","map","client","newObj","label","name","chatId","push","getImage","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","data","response","wrap","_context","prev","next","console","log","FormData","append","uploadFile","sent","path","split","stop","apply","arguments","onSendText","_ref2","_callee3","message","_context3","play","button","receivers","JSON","stringify","datestart","Date","now","delivered","newDistribution","_ref3","_callee2","user","index","keyboard","sendToTelegram","url_send_msg","url_send_photo","sendPhotoToTelegram","form","_message","_context2","filter","toString","inline_keyboard","callback_data","concat","replace","$host","get","post","senderId","receiverId","conversationId","type","is_bot","messageId","result","message_id","buttons","newMessage","getDistributions","length","_x","_x2","_jsxs","className","children","_jsx","AppSidebar","AppHeader","CContainer","lg","Suspense","fallback","CSpinner","color","_Fragment","CRow","CCol","xs","CCard","CCardBody","CAlert","dismissible","onClose","CForm","style","CFormLabel","htmlFor","MultiSelect","options","onChange","overrideStrings","CFormCheck","id","e","target","defaultChecked","CFormTextarea","rows","placeholder","CFormInput","files","onFileChange","cursor","onClick","preventDefault","display","md","textAlign","CButton","marginRight","AppFooter"],"sourceRoot":""}