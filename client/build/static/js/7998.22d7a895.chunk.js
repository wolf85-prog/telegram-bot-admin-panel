"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[7998],{17998:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var l=t(65043),a=t(93946),o=t(67926),n=t(31004),i=(t(26016),t(6574)),r=t(15830),c=t(73216),d=t(85416),m=t(42507),u=t(99647),g=t(70579);const p=()=>{const e="5836103512:AAFoXHwI8PsQ6_xeqcx0IawMbc7njLwJydQ",s="https://proj.uley.team",t="1775583141",{users:p}=(0,i.d)(),{addNewMessage:h,setDistributions:x}=(0,i.d)(),[v,f]=(0,l.useState)([]),[j,b]=(0,l.useState)(null),[y,w]=(0,l.useState)(""),[I,_]=(0,l.useState)(0),[S,N]=(0,l.useState)(!1),[C,k]=(0,l.useState)(!1),[F,J]=(0,l.useState)(!1),[T,O]=(0,l.useState)(""),[D,$]=(0,l.useState)(),[A,Q]=(0,l.useState)(""),[K,M]=(0,l.useState)(""),U=new Audio(u),q=(0,c.Zp)();(0,l.useEffect)((()=>{const e=[];p.map((s=>{const t={name:s.name,code:s.chatId};e.push(t)})),console.log("users: ",e),f(e)}),[p]);(0,l.useEffect)((()=>{(async()=>{if(D){console.log("file:",D);const e=new FormData;e.append("name",D.name),e.append("photo",D);let s=await(0,m.QM)(e);console.log("response: ",s.data.path),M(s.data.path.split(".team")[1])}})()}),[D]);return(0,g.jsxs)("div",{className:"dark-theme",children:[(0,g.jsx)(o.GK,{}),(0,g.jsxs)("div",{className:"wrapper d-flex flex-column min-vh-100 bg-uley",children:[(0,g.jsx)(o.jJ,{}),(0,g.jsx)("div",{className:"body flex-grow-1 px-3",children:(0,g.jsx)(a.T5,{lg:!0,children:(0,g.jsx)(l.Suspense,{fallback:(0,g.jsx)(a.JT,{color:"primary"}),children:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h2",{children:"\u041d\u043e\u0432\u0430\u044f \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0430"}),(0,g.jsx)(a.sK,{children:(0,g.jsx)(a.UF,{xs:!0,children:(0,g.jsx)(a.E$,{className:"mb-4",children:(0,g.jsxs)(a.W6,{children:[(0,g.jsx)(a.kj,{color:"success",dismissible:!0,visible:S,onClose:()=>N(!1),children:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e!"}),(0,g.jsxs)(a.qI,{children:[(0,g.jsxs)("div",{className:"mb-3",style:{color:"#f3f3f3"},children:[(0,g.jsx)(a.A6,{htmlFor:"exampleFormControlInput1",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u0435\u0439:"}),(0,g.jsx)(n.K,{id:"exampleFormControlInput1",value:j,onChange:e=>(e=>{console.log(j),b(e.value)})(e),options:v,optionLabel:"name",maxSelectedLabels:3,className:"w-full md:w-20rem",filter:!0,virtualScrollerOptions:{itemSize:43},placeholder:""}),(0,g.jsxs)("p",{style:{color:"#767676"},children:["\u041f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u0435\u0439: ",(0,g.jsx)("span",{children:null===j||void 0===j?void 0:j.length})]})]}),(0,g.jsx)("div",{className:"mb-3",style:{color:"#f3f3f3"},children:(0,g.jsx)(a.CK,{id:"flexCheckDefault",label:"\u0414\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0430\u0434\u043c\u0438\u043d\u043a\u0443",onChange:e=>{console.log(!F),J(!F)},defaultChecked:F})}),(0,g.jsx)("div",{className:"mb-3",children:(0,g.jsx)(a.Im,{id:"exampleFormControlTextarea1",rows:3,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",onChange:e=>{w(e.target.value),_(e.target.value.length)},value:y})}),(0,g.jsx)("div",{className:"mb-6",style:{color:"#8f8888"},children:(0,g.jsx)(a.OG,{type:"file",id:"formFile",label:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"photo",onChange:e=>(e=>{$(e.target.files[0]),Q(e.target.value)})(e),value:A})}),(0,g.jsx)("div",{className:"mb-3"}),(0,g.jsx)("div",{className:"mb-3 text-center",children:(0,g.jsxs)("p",{style:{color:"#fff",cursor:"pointer"},onClick:e=>{e.preventDefault(),k(!C)},children:[" ",C?"- \u0423\u0431\u0440\u0430\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0443":"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0443"]})}),(0,g.jsx)(a.qI,{className:"row g-3",style:{color:"#8f8888",display:C?"block":"none"},children:(0,g.jsx)(a.UF,{md:6,children:(0,g.jsx)(a.OG,{type:"text",id:"inputTextButton",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043d\u043e\u043f\u043a\u0438",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442",onChange:e=>{O(e.target.value)},value:T})})}),(0,g.jsx)("br",{}),(0,g.jsxs)("div",{className:"mb-3",style:{textAlign:"right"},children:[(0,g.jsx)(a.Q_,{color:"secondary",style:{marginRight:"15px"},onClick:()=>{q("/distribution")},children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,g.jsx)(a.Q_,{color:"primary",onClick:async()=>{let l=[];U.play();const a={name:"\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430",text:y,image:s+K,button:T,receivers:JSON.stringify(j),datestart:Date.now(),delivered:"true"};console.log("message send button: ",a);const o=await(0,d.Bx)(a);j.map((async(a,n)=>{setTimeout((async()=>{console.log("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e ID: "+a.code+" \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 "+y+" \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e! \u041a\u043d\u043e\u043f\u043a\u0430 "+T+" \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430!"),l.push({label:a.name,value:a.code,status:500,mess:null});let i=p.find((e=>e.chatId===a.code));console.log("client: ",i);const c=JSON.stringify({inline_keyboard:[[{text:T,callback_data:"/report"}]]});let u;if(""!==y){console.log(l,o);const s=`https://api.telegram.org/bot${e}/sendMessage?chat_id=${a.code}&parse_mode=html&text=${y.replace(/\n/g,"%0A")}`;console.log("url_send_msg: ",s),u=await r.dU.get(s),console.log("sendToTelegram: ",u);const{status:t}=u;var g,x;if(200===t)console.log("\u0441\u0442\u0430\u0442\u0443\u0441 200 \u0442\u0435\u043a\u0441\u0442",l,o.id),l[n-1].status=200,l[n-1].mess=null===(g=u.data)||void 0===g||null===(x=g.result)||void 0===x?void 0:x.message_id,console.log("res: ",{receivers:JSON.stringify(l)},o.id),await(0,d.tJ)({receivers:JSON.stringify(l)},o.id)}const v=`https://api.telegram.org/bot${e}/sendPhoto?chat_id=${a.code}&reply_markup=${c}`;let f;if(console.log("url_send_photo: ",v),D){const e=new FormData;e.append("photo",D),f=await r.dU.post(v,e),console.log("sendPhotoToTelegram: ",f);const{status:s}=f;var j,b;if(200===s&&""===y)console.log("\u0441\u0442\u0430\u0442\u0443\u0441 200 \u0444\u043e\u0442\u043e"),l[n-1].status=200,l[n-1].mess=null===(j=f.data)||void 0===j||null===(b=j.result)||void 0===b?void 0:b.message_id,await(0,d.tJ)({receivers:JSON.stringify(l)},o.id)}if(F){let e={};e=D?{senderId:t,receiverId:a.code,conversationId:i.conversationId,type:"image",text:s+K,is_bot:!0,messageId:f.data.result.message_id,buttons:T}:{senderId:t,receiverId:a.code,conversationId:i.conversationId,type:"text",text:y,is_bot:!0,messageId:u.data.result.message_id,buttons:""},console.log("message send: ",e),await(0,m.iW)(e),D?h(a.code,s+K,"image",T,i.conversationId,f.data.result.message_id):h(a.code,y,"text","",i.conversationId,u.data.result.message_id)}}),3e3*++n)})),b([]),J(!1),w(""),k(!1),O(""),N(!0),Q("")},children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443"})]})]})]})})})})]})})})}),(0,g.jsx)(o.jI,{})]})]})}},99647:(e,s,t)=>{e.exports=t.p+"static/media/distribution_sound.77a858448f3b5ce5598d.mp3"}}]);
//# sourceMappingURL=7998.22d7a895.chunk.js.map